\documentclass[shadesubsections,compress,14pt,mathserif]{beamer}
\usepackage[danish]{babel}	
\usepackage{tikz,circuitikz}
\usetikzlibrary{shapes, positioning}
\usenavigationsymbolstemplate{}
\usepackage{xcolor,pgfplots}
\usepackage[absolute,overlay]{textpos}
\usepackage{amsthm,amsfonts}
%\usepackage[T1]{fontenc}
% \usepackage{fullpage}
% Dokumentets sprog
%\usepackage{mathtools}
%\usepackage{pxfonts}
\usepackage{eulervm}
\usepackage[export]{adjustbox}
\everymath{\color{purple}}
% Class options include: notes, notesonly, handout, trans,
%                        hidesubsections, shadesubsections,
%                        inrow, blue, red, grey, brown

% Theme for beamer presentation.
%\usepackage{beamertheme} 
% Other themes include: beamerthemebars, beamerthemelined, 
%                       beamerthemetree, beamerthemetreebars  
\newcommand{\minus}{\scalebox{0.5}[1.0]{\( - \)}}
\newcommand{\adv}{\ensuremath{\mathcal A}}
\newcommand{\F}{\ensuremath{{\mathbb F}}}
\renewcommand{\P}{\ensuremath{{\mathbb P}}}
\newcommand{\Z}{\ensuremath{{\mathbb Z}}\xspace}
\newcommand{\Fclosure}{\ensuremath{{\overline{\mathbb{F}}}_p}}
\newcommand{\set}[1]{\ensuremath{\left\{#1\right\}}}
\newcommand{\bin}{\ensuremath{\set{0,1}}}
\newcommand{\cube}{\ensuremath{\bin^n}}

\newcommand{\sett}[2]{\ensuremath{\left\{#1\right\}_{#2}}}
\newcommand{\enc}[1]{\ensuremath{\left[#1\right ]}}
% \newcommand{\kzg}[1]{\ensuremath{\enc{#1(x)}}}
\newcommand{\cm}{\ensuremath{\mathsf{cm}}}
\newcommand{\kzg}[1]{\cm(#1)}
\newcommand{\open}[1]{\ensuremath{\mathsf{open}(#1)}}
\newcommand{\verify}[1]{\ensuremath{\mathsf{verify}(#1)}}
\newcommand{\defeq}{\ensuremath{:=}}
\newcommand{\helper}{\ensuremath{\mathcal{H}}}
\newcommand{\ver}{\ensuremath{\mathcal{V}}}
\newcommand{\prv}{\ensuremath{\mathcal{P}}}
 \newcommand{\polysofdeg}[1]{\F_{< #1}[X]}
%  \newcommand{\endoss}{\ensuremath{\mathrm{END}_E}}
 \newcommand{\hl}[1]{\textbf{\textit{#1}}}
 \newcommand{\polys}{\F[X]}
\newcommand{\acc}{{\mathbf{acc}}}
\newcommand{\ideal}{\mathbf{I}}
\newcommand{\gen}{\alpha}
\newcommand{\spac}{\\  \vspace{0.2in} \noindent}
\newcommand{\polylog}{\ensuremath{\mathsf{polylog}}\xspace}
% \renewcommand{\bf}{\begin{frame}}
% \newcommand{\ef}{\end{frame}}
%\setbeamersize{text margin left=3mm,text margin right=3mm}  
\newcommand{\nl}{\\ \pause \vspace{0.2in}}
\newcommand{\nlnp}{\\ \vspace{0.2in}}
\newcommand{\stitle}[1]{{\large{\textcolor{purple}{\emph{#1}}}}}
\DeclareMathAlphabet{\mathpgoth}{OT1}{pgoth}{m}{n}	
\newcommand{\cq}{\mathpgoth{cq} }
\newcommand{\cqstar}{\ensuremath{\mathpgoth{cq^{\mathbf{*}} }}\xspace}
\newcommand{\flookup}{\ensuremath{\mathsf{\mathpgoth{Flookup}}}\xspace}
\newcommand{\baloo}{\ensuremath{\mathrm{ba}\mathit{loo}}\xspace}
% \newcommand{\caulkp}{\ensuremath{\mathsf{\mathrel{Caulk}\mathrel{\scriptstyle{+}}}}\xspace}
\newcommand{\caulk}{\ensuremath{\mathsf{Caulk}}\xspace}
\newcommand{\plookup}{\ensuremath{\mathpgoth{plookup}}\xspace}
\newcommand{\srs}{\ensuremath{\mathsf{srs}}}
\newcommand{\tablegroup}{\ensuremath{\mathbb{H}}\xspace}
\newcommand{\V}{\ensuremath{\mathbf{V} }\xspace}
\newcommand{\zfin}{\ensuremath{z_{\mathscr{final}}}}
\newcommand{\rel}{\ensuremath{\mathcal{R}}}
\newcommand{\vk}{\ensuremath{\mathrm{vk} }}
\newcommand{\numreads}{\ensuremath{\mathrm{numreads} }}
\newcommand{\add}{\ensuremath{\mathrm{add} }}
\newcommand{\adds}{\ensuremath{\mathrm{add}s }}
\renewcommand{\count}{\ensuremath{\mathrm{count} }}
\newcommand{\addcount}{\ensuremath{\mathrm{acount} }}
\renewcommand{\read}{\ensuremath{\mathrm{read} }}
\renewcommand{\note}{\ensuremath{\mathrm{note} }}
\newcommand{\vknext}{\ensuremath{\mathrm{vk_{next}} }}
\newcommand{\vkcur}{\ensuremath{\mathrm{vk_{cur}} }}
\newcommand{\args}{\ensuremath{\mathrm{args} }}
\newcommand{\stack}{\ensuremath{\mathrm{stack} }}
\newcommand{\argscur}{\ensuremath{\mathrm{args_{cur}} }}
\newcommand{\argsnext}{\ensuremath{\mathrm{args_{next}} }}
% \newcommand{\caulk}{{\mathsf{Caulk}}}
% \newcommand{\caulkp}{{\mathsf{\mathrel{Caulk}\mathrel{\scriptstyle{+}}}}}
\newcommand{\bigspace}{\ensuremath{\mathbb{V}}}

%\setbeamersize{text margin left=3mm,text margin right=3mm} 
\title{\large{From IVCs to RCGs}}    % Enter your title between curly braces
\author{\small{Ariel Gabizon}\\                 % Enter your name between curly braces
\tt{\footnotesize{Aztec Labs}                                       } }      % Enter your institute name between curly braces
\date{}                    % Enter the date or \today between curly braces
%\usefonttheme{professionalfonts}
%\usefonttheme[onlymath]{serif}
\begin{document}
\boldmath
% Creates title page of slide show using above information
\begin{frame}
  \titlepage
\end{frame}


% \begin{frame}
% \large{plonk is a protocol to make short proofs about circuit satisfiability.}
%  \begin{figure}
%   \includegraphics[width=260pt]{circuit.png}
% \end{figure}
% \end{frame}
\begin{frame}
 \frametitle{Outline}
 
 \begin{itemize}
  \item The Aztec Smart Contract system
  \item RCG
  \item Global state via log derivative
  \item A theoretical interlude
 \end{itemize}
\end{frame}
\begin{frame}
 \frametitle{The Aztec Private Smart Contract System}
A \emph{contract} has functions - represented by \emph{verification keys} .

$A - \vk_A$\nl
$B - \vk_B$

Function contracts can 
 - call other functions in same/other contract
 \end{frame}
 
\begin{frame}
\frametitle{How do circuits  ``call each other''?}
\emph{Example:} Want to prove execution of
$A(\args_A)\{$
..
..
$B(\args_B)$
..
..
$\}$

\textit{Idea: $A$'s public input will contain $\vk_B$ and $\args_B$}

\end{frame}
\begin{frame}
\frametitle{How do circuits  ``call each other''?}
\textit{Idea: $A$'s public input will contain $\vk_B$ and $\args_B$}
$x_A=(\args_A,\vk_B,\args_B)$
$x_B=(\args_B)$.
Construct proofs - 
  $\pi_A$ for $A$ with public input $x_A=(\args_A,\vk_B,\args_B)$
  $\pi_B$ for $B$ with public input $x_B=(\args_B)$
  
  verify $(x_A,\pi_A)$ with verification key $\vk_A$
            $(x_B,\pi_B)$ with $\vk_B$
\end{frame}
 
\begin{frame}
 \frametitle{Viewing as IVC of a fixed function}
 $F(\vkcur,x=(\argscur,\vknext,\argsnext),\pi,\stack)$
 \begin{enumerate}
  \item Check $(\vkcur,\argscur)$ is top element in \stack and pop it off.
  \item Check that $\ver(\vkcur,x,\pi)=\acc$.
  \item Push $(\vknext,\argsnext)$ to top of \stack.
 \end{enumerate}

\end{frame}
 
\begin{frame}
 \frametitle{ But we forgot global state }
A \emph{contract} has functions - represented by \emph{verification keys} .

$A - \vk_A$\nl
$B - \vk_B$
{\textcolor{red}{A contract has \emph{notes} representing its state.}}
$\note_1$
$\note_2$
$\note_3$
 Contract functions can 
 \begin{itemize}
  \item Call other functions in same/other contract
 \item \textcolor{red}{add/read/delete contract notes}
 \end{itemize}
 \end{frame}
% \begin{frame}
%  \frametitle{Global State}
%  We add to the function public inputs the  note operations (with time stamps)
%  
%  $x_A=(\args_A,\vk_B,\args_B,[\read,\note,8])$
%  $x_B=(\vk_B,\args_B,[\add,\note,3])$
%  
%  \emph{Problem:} When verifying proof for $A$ we don't know whether in a future IVC iteration we'll see \note created (with earlier timestamp)\pause
%  
%  
%  ``Order of proving is different than order of execution``
% \end{frame}
\begin{frame}
 \frametitle{RCG - Repeated Computation with Global state}
 Like IVC...but
 \begin{itemize}
  \item Computation ends before proving starts.
  \item Prover memory allowed to depend on size of global state in addition to memory for one iteration
 \end{itemize}

\end{frame}
\begin{frame}
 \frametitle{RCG - Repeated Computation with Global state}
 Like IVC...but
 \begin{itemize}
  \item Computation ends before proving starts.
  \item Prover memory allowed to depend on size of global state in addition to memory for one iteration
 \end{itemize}
\end{frame}
% \begin{frame}
%  \frametitle{RCG - Simplfied dfn}
% \noindent
% \emph{Transition predicate:} $F(Z,W,Z^*,S)\to \set{\acc,\rej}$. 
% \emph{Final predicate} $f(S_1,\ldots,S_n)\to \set{\acc,\rej}$.
% 
% The RCG relation $\rel=\rel_{F,f}$ consists of pairs $(X,W)$ such that
% $X=(\zfin,n),W=(z=(z_0,\ldots,z_n),w=(w_1\ldots,w_n),s=(s_1,\ldots,s_n))$ such that
% \begin{itemize}
%  \item $z_n=\zfin$.
%  \item For each $i\in [n]$, $F(z_{i-1},w_i,z_i,s_i)=\acc$.
%  \item $f(s_1,\ldots,s_n)=\acc$.
% \end{itemize}
% 
% 
% We say a zk-SNARK for \rel is \emph{space-efficient} if given $s$ and streaming access
% to $z$ and $w$ $P$ requires space $\~$ $O(|F|+|s|)$.
% \end{frame}
\begin{frame}
\frametitle{ D\'ej\`a vu from previous talk: Memory checks with log-derivative {\small [Eagen22, Hab{\"{o}}ck}22]}.
In $\add$ ops also write the number of times note is read
e.g. $a=(\add,\note,\numreads)$
In $\read$ ops write the timestamp of note addition.
e.g. $r=(\read,\note,\addcount,\count)$.

\begin{itemize}
 \item For each read $r$ we check that $\addcount<\count$.
 \item Prover hashes note operations from all function calls to get challenge $\beta\in \F$.
 \item Final proof will check that
 \[\sum_{r\in \reads} \frac{1}{\note + \beta \cdot \addcount} = \sum _{a\in \adds}{\frac{\numreads}{\note+\beta \cdot \count} \]
\end{itemize}

\end{frame}
\begin{frame}
 \frametitle{Theoretical interlude - The recursive Algebraic Model [LS23]}
 AGM[FKL] - Given SRS $v\in \G^n$,
 when $\adv$ outputs $a\in \G$ it must output
 $c\in \F^n$ such that $a=\sum_{i=1}^n c_i v_i$.
 
 Fix in advance representation function for $\G$
 $\repr:\G\to \F^2$.
 What if for some $i<n$, $(c_i,c_{i+1}) = \repr(b)$ for some $b\in \G$?
 Then a \emph{recursive Algebraic adversary} must output $c'\in \F^n$ with
 $b=\sum_{i=1}^n c'_i v_i$.
\end{frame}

% \begin{frame}
% 
%  For more details see:
%  \begin{figure}
%   \includegraphics[width=260pt]{lx23.png}
% \end{figure}
%  \textit{For more elementary approach with better final constants see Circle STARK[HLP24]}
% \end{frame}
% 
\end{document}
% \begin{frame}
% \frametitle{The places of $K=\F(X)$: }
%   Choose $a\in F$. Write $r\in K$ as\\
%   $r(X)=(X-a)^{v_a} \frac{f(X)}{g(X)}$, $f,g\in \F[X]; f(a),g(a)\neq 0$.\nl
% 
% $v$ is the \emph{valuation of $r$ at $a$}.
% Take $R_a\defeq \{r\in K| v_a(r)\geq 0 \}$.\nl
% $R_a$ is a place of $K$.
% \end{frame}
% \begin{frame}
% The unique maximal ideal of $R_a$ is $I_a=\set{(X-a)\cdot r|r\in R_a}$\nl
% \textit{Cool thing: $R_a/I_a=\F$. And we can evaluate $r\in R_a$ at $a$ by taking $r\;\mod\; I_a$}\nl
% This gives the same result as ``normal'' evaluation!
%  
% \end{frame}
% \begin{frame}
%  \frametitle{Regular FFT via GFFT}
% \begin{enumerate}
%  \item Applying the map $\tau(x)=-x$.
%  \item Applying 2-1 map $x\to x^2$.\nl
% \end{enumerate}
% \emph{How do these operations look in the framework of places?} 
% \end{frame}
